<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DC Cable Diameter Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                color-scheme: dark;
            }
        }

        /* Screen reader only class */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        .sr-only:focus,
        .focus\:not-sr-only:focus {
            position: static;
            width: auto;
            height: auto;
            padding: inherit;
            margin: inherit;
            overflow: visible;
            clip: auto;
            white-space: normal;
        }
    </style>
</head>

<body class="bg-gray-50 dark:bg-gray-900 min-h-screen py-8 px-4">
    <!-- Skip to main content link for screen readers -->
    <a href="#main-content"
        class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-purple-600 focus:text-white focus:rounded-md">Skip
        to main content</a>

    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <header class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-lg shadow-lg p-6 mb-8"
            role="banner">
            <div class="flex justify-between items-start">
                <div class="flex-1">
                    <h1 class="text-3xl font-bold mb-2" data-i18n="title">DC Cable Diameter Calculator</h1>
                    <p class="text-purple-100" data-i18n="subtitle">Calculate required cable cross-sectional area and
                        diameter for DC electrical systems</p>
                    <p class="text-sm text-purple-200 mt-2" data-i18n="supports">Supports 12V, 24V, 48V, 50V DC systems
                    </p>
                </div>
                <div class="ml-4">
                    <label for="language" class="block text-sm font-medium text-purple-100 mb-1"
                        data-i18n="language">Language</label>
                    <select id="language" onchange="changeLanguage(this.value)" aria-label="Select language"
                        class="px-3 py-2 bg-white/10 backdrop-blur-sm border border-white/20 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-white/50">
                        <option value="en">English</option>
                        <option value="de">Deutsch</option>
                        <option value="fr">Français</option>
                        <option value="sv">Svenska</option>
                    </select>
                </div>
            </div>
        </header>

        <!-- Calculator Form -->
        <main id="main-content" role="main">
            <section class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6" aria-labelledby="input-heading">
                <h2 id="input-heading" class="text-xl font-semibold mb-4 text-gray-800 dark:text-gray-200"
                    data-i18n="inputParameters">Input
                    Parameters</h2>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- System Voltage -->
                    <div>
                        <label for="voltage" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                            <span data-i18n="systemVoltage">System Voltage (V)</span> <span class="text-red-500"
                                aria-label="required">*</span>
                        </label>
                        <input type="number" id="voltage" name="voltage" step="0.1" min="0" aria-required="true"
                            aria-describedby="voltage-desc"
                            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white"
                            placeholder="12, 24, 48, 50" required>
                        <span id="voltage-desc" class="sr-only">Enter system voltage in volts, maximum 50V</span>
                    </div>

                    <!-- Current -->
                    <div>
                        <label for="current" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                            <span data-i18n="current">Current (A)</span> <span class="text-red-500"
                                aria-label="required">*</span>
                        </label>
                        <input type="number" id="current" name="current" step="0.1" min="0" aria-required="true"
                            aria-describedby="current-desc"
                            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white"
                            placeholder="10.0" required>
                        <span id="current-desc" class="sr-only">Enter current in amperes</span>
                    </div>

                    <!-- Cable Length -->
                    <div>
                        <label for="length" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                            <span data-i18n="cableLength">Cable Length (m)</span> <span class="text-red-500"
                                aria-label="required">*</span>
                        </label>
                        <input type="number" id="length" name="length" step="0.1" min="0" aria-required="true"
                            aria-describedby="length-desc"
                            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white"
                            placeholder="5.0" required>
                        <span id="length-desc" class="sr-only">Enter cable length in meters</span>
                    </div>

                    <!-- Max Voltage Drop -->
                    <div>
                        <label for="voltageDrop" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                            data-i18n="maxVoltageDrop">Max Voltage Drop (%)</label>
                        <input type="number" id="voltageDrop" name="voltageDrop" step="0.1" min="0" max="10" value="3.0"
                            aria-describedby="voltageDrop-desc"
                            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white"
                            placeholder="3.0">
                        <span id="voltageDrop-desc" class="sr-only">Optional: Maximum allowed voltage drop percentage,
                            default is 3%</span>
                    </div>

                    <!-- Ambient Temperature -->
                    <div>
                        <label for="temperature" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                            data-i18n="ambientTemperature">Ambient Temperature</label>
                        <div class="flex gap-2">
                            <input type="number" id="temperature" name="temperature" step="0.1" value="20.0"
                                aria-label="Ambient temperature value"
                                class="flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white"
                                placeholder="20.0">
                            <label for="tempUnit" class="sr-only">Temperature unit</label>
                            <select id="tempUnit" name="tempUnit" aria-label="Temperature unit"
                                class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white">
                                <option value="C">°C</option>
                                <option value="F">°F</option>
                            </select>
                        </div>
                    </div>

                    <!-- Round Trip -->
                    <div>
                        <label for="roundTrip" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                            data-i18n="lengthType">Length Type</label>
                        <select id="roundTrip" name="roundTrip"
                            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white">
                            <option value="false">One-way</option>
                            <option value="true">Round trip</option>
                        </select>
                    </div>

                    <!-- Material -->
                    <div>
                        <label for="material" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                            data-i18n="cableMaterial">Cable Material</label>
                        <select id="material" name="material"
                            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white">
                            <option value="copper">Copper</option>
                            <option value="aluminum">Aluminum</option>
                        </select>
                    </div>

                    <!-- Installation Method -->
                    <div>
                        <label for="installation"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                            data-i18n="installationMethod">Installation Method</label>
                        <select id="installation" name="installation"
                            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white">
                            <option value="air">In Air (best cooling)</option>
                            <option value="conduit">In Conduit (+10°C)</option>
                            <option value="isolated">Isolated/Insulated (+20°C)</option>
                        </select>
                    </div>

                    <!-- Wire Type -->
                    <div>
                        <label for="wireType" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                            data-i18n="wireType">Wire Type</label>
                        <select id="wireType" name="wireType"
                            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white">
                            <option value="flry">FLRY (105°C max)</option>
                            <option value="flry-a">FLRY-A (105°C max)</option>
                            <option value="flry-b">FLRY-B (105°C max)</option>
                            <option value="thhn">THHN (90°C max)</option>
                            <option value="thwn">THWN (75°C max)</option>
                            <option value="xlpe">XLPE (90°C max)</option>
                            <option value="pvc">PVC (70°C max)</option>
                            <option value="silicon">Silicone (200°C max)</option>
                            <option value="generic" selected>Generic (90°C max)</option>
                        </select>
                    </div>
                </div>

                <button onclick="calculate()" id="calculateBtn" type="button" aria-label="Calculate cable size"
                    class="mt-6 w-full bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-200 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2"
                    data-i18n="calculate">
                    Calculate
                </button>
            </section>

            <!-- Results Section -->
            <section id="results" class="hidden bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6"
                aria-labelledby="results-heading" aria-live="polite" aria-atomic="true">
                <h2 id="results-heading" class="text-xl font-semibold mb-4 text-gray-800 dark:text-gray-200"
                    data-i18n="calculationResults">
                    Calculation Results</h2>

                <!-- Screen reader announcement region -->
                <div id="sr-announcement" class="sr-only" aria-live="polite" aria-atomic="true"></div>

                <!-- Input Summary -->
                <div class="mb-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                    <h3 class="font-semibold text-gray-800 dark:text-gray-200 mb-3" data-i18n="inputParams">Input
                        Parameters
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-2 text-sm">
                        <div><span class="text-gray-600 dark:text-gray-400" data-i18n="systemVoltageLabel">System
                                Voltage:</span> <span id="result-voltage"
                                class="font-semibold text-gray-800 dark:text-gray-200"></span></div>
                        <div><span class="text-gray-600 dark:text-gray-400" data-i18n="currentLabel">Current:</span>
                            <span id="result-current" class="font-semibold text-gray-800 dark:text-gray-200"></span>
                        </div>
                        <div><span class="text-gray-600 dark:text-gray-400" data-i18n="cableLengthLabel">Cable
                                Length:</span> <span id="result-length"
                                class="font-semibold text-gray-800 dark:text-gray-200"></span></div>
                        <div><span class="text-gray-600 dark:text-gray-400" data-i18n="maxVoltageDropLabel">Max Voltage
                                Drop:</span> <span id="result-drop"
                                class="font-semibold text-gray-800 dark:text-gray-200"></span></div>
                        <div><span class="text-gray-600 dark:text-gray-400" data-i18n="materialLabel">Material:</span>
                            <span id="result-material" class="font-semibold text-gray-800 dark:text-gray-200"></span>
                        </div>
                        <div><span class="text-gray-600 dark:text-gray-400" data-i18n="wireTypeLabel">Wire Type:</span>
                            <span id="result-wiretype" class="font-semibold text-gray-800 dark:text-gray-200"></span>
                        </div>
                        <div><span class="text-gray-600 dark:text-gray-400"
                                data-i18n="installationLabel">Installation:</span> <span id="result-installation"
                                class="font-semibold text-gray-800 dark:text-gray-200"></span>
                        </div>
                        <div><span class="text-gray-600 dark:text-gray-400" data-i18n="ambientTempLabel">Ambient
                                Temp:</span> <span id="result-ambient"
                                class="font-semibold text-gray-800 dark:text-gray-200"></span></div>
                        <div><span class="text-gray-600 dark:text-gray-400" data-i18n="effectiveTempLabel">Effective
                                Temp:</span> <span id="result-effective-temp"
                                class="font-semibold text-gray-800 dark:text-gray-200"></span>
                        </div>
                    </div>
                </div>

                <!-- Warning -->
                <div id="warning" class="hidden mb-4 p-4 rounded-lg" role="alert" aria-live="assertive"></div>

                <!-- Required Size -->
                <div
                    class="mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800">
                    <h3 class="font-semibold text-blue-900 dark:text-blue-200 mb-3" data-i18n="requiredCableSize">
                        Required
                        Cable Size</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <span class="text-sm text-blue-700 dark:text-blue-300"
                                data-i18n="crossSectionalArea">Cross-Sectional Area:</span>
                            <div class="text-2xl font-bold text-blue-900 dark:text-blue-100" id="result-area"></div>
                        </div>
                        <div>
                            <span class="text-sm text-blue-700 dark:text-blue-300" data-i18n="diameter">Diameter:</span>
                            <div class="text-2xl font-bold text-blue-900 dark:text-blue-100" id="result-diameter"></div>
                        </div>
                        <div>
                            <span class="text-sm text-blue-700 dark:text-blue-300" data-i18n="cableWeight">Cable
                                Weight:</span>
                            <div class="text-2xl font-bold text-blue-900 dark:text-blue-100" id="result-weight"></div>
                        </div>
                    </div>
                </div>

                <!-- Recommended Sizes -->
                <div class="mb-6 p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800"
                    role="region" aria-labelledby="recommended-heading">
                    <h3 id="recommended-heading" class="font-semibold text-green-900 dark:text-green-200 mb-3"
                        data-i18n="recommendedStandardSizes">
                        Recommended Standard Sizes</h3>
                    <dl class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <dt class="text-sm text-green-700 dark:text-green-300" data-i18n="metric">Metric:</dt>
                            <dd class="text-xl font-bold text-green-900 dark:text-green-100" id="result-metric"
                                aria-label="Recommended metric size"></dd>
                            <dd class="text-xs text-green-600 dark:text-green-400" id="result-metric-diff"></dd>
                            <dd class="text-sm text-green-700 dark:text-green-300 mt-1" id="result-metric-weight"></dd>
                        </div>
                        <div>
                            <dt class="text-sm text-green-700 dark:text-green-300" data-i18n="awg">AWG:</dt>
                            <dd class="text-xl font-bold text-green-900 dark:text-green-100" id="result-awg"
                                aria-label="Recommended AWG size"></dd>
                            <dd class="text-xs text-green-600 dark:text-green-400" id="result-awg-diff"></dd>
                            <dd class="text-sm text-green-700 dark:text-green-300 mt-1" id="result-awg-weight"></dd>
                        </div>
                    </dl>
                </div>

                <!-- Voltage Drop with Recommended Sizes -->
                <div class="p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800"
                    role="region" aria-labelledby="voltage-drop-heading">
                    <h3 id="voltage-drop-heading" class="font-semibold text-purple-900 dark:text-purple-200 mb-3"
                        data-i18n="voltageDropRecommended">
                        Voltage Drop with Recommended Sizes</h3>
                    <dl class="space-y-2">
                        <div>
                            <dt class="text-sm text-purple-700 dark:text-purple-300" id="result-drop-metric-label"></dt>
                            <dd class="text-lg font-semibold text-purple-900 dark:text-purple-100"
                                id="result-drop-metric" aria-label="Voltage drop with metric size">
                            </dd>
                        </div>
                        <div>
                            <dt class="text-sm text-purple-700 dark:text-purple-300" id="result-drop-awg-label"></dt>
                            <dd class="text-lg font-semibold text-purple-900 dark:text-purple-100" id="result-drop-awg"
                                aria-label="Voltage drop with AWG size">
                            </dd>
                        </div>
                    </dl>
                </div>

                <!-- Safety Warning -->
                <div class="mt-6 p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800"
                    role="alert">
                    <div class="font-semibold text-yellow-800 dark:text-yellow-200 mb-2" data-i18n="safetyWarning">
                        Safety
                        Warning:</div>
                    <div class="text-sm text-yellow-700 dark:text-yellow-300" data-i18n="safetyText">Always consult with
                        a
                        qualified electrician or electrical engineer for critical applications.</div>
                    <div class="text-xs text-yellow-600 dark:text-yellow-400 mt-2" data-i18n="safetyNote">This tool
                        provides
                        calculations for voltage drop only and does not replace professional engineering judgment.</div>
                </div>
            </section>
        </main>
    </div>

    <!-- Footer -->
    <div class="mt-8 text-center text-sm text-gray-600 dark:text-gray-400">
        <p>⚠️ <strong data-i18n="safetyWarning">Safety Warning:</strong> <span data-i18n="safetyText">Always consult
                with a qualified electrician or electrical engineer for critical applications.</span></p>
        <p class="mt-2" data-i18n="safetyNote">This tool provides calculations for voltage drop only and does not
            replace professional engineering judgment.</p>
    </div>
    </div>

    <script>
        // Language and translations
        let currentLanguage = localStorage.getItem('language') || 'en';

        const translations = {
            en: {
                title: "DC Cable Diameter Calculator",
                subtitle: "Calculate required cable cross-sectional area and diameter for DC electrical systems",
                supports: "Supports 12V, 24V, 48V, 50V DC systems",
                language: "Language",
                inputParameters: "Input Parameters",
                systemVoltage: "System Voltage (V)",
                current: "Current (A)",
                cableLength: "Cable Length (m)",
                maxVoltageDrop: "Max Voltage Drop (%)",
                ambientTemperature: "Ambient Temperature",
                lengthType: "Length Type",
                oneWay: "One-way",
                roundTrip: "Round trip",
                cableMaterial: "Cable Material",
                installationMethod: "Installation Method",
                wireType: "Wire Type",
                calculate: "Calculate",
                calculationResults: "Calculation Results",
                inputParams: "Input Parameters",
                systemVoltageLabel: "System Voltage:",
                currentLabel: "Current:",
                cableLengthLabel: "Cable Length:",
                maxVoltageDropLabel: "Max Voltage Drop:",
                materialLabel: "Material:",
                wireTypeLabel: "Wire Type:",
                installationLabel: "Installation:",
                ambientTempLabel: "Ambient Temp:",
                effectiveTempLabel: "Effective Temp:",
                requiredCableSize: "Required Cable Size",
                crossSectionalArea: "Cross-Sectional Area:",
                diameter: "Diameter:",
                cableWeight: "Cable Weight:",
                recommendedStandardSizes: "Recommended Standard Sizes",
                metric: "Metric:",
                awg: "AWG:",
                voltageDropRecommended: "Voltage Drop with Recommended Sizes",
                roundedUp: "rounded up, oversized by",
                largestAvailable: "largest available, undersized by",
                with: "With",
                safetyWarning: "Safety Warning:",
                safetyText: "Always consult with a qualified electrician or electrical engineer for critical applications.",
                safetyNote: "This tool provides calculations for voltage drop only and does not replace professional engineering judgment.",
                errorInvalidVoltage: "Error: Invalid voltage. Please enter a value between 0 and {maxVoltage}V.",
                errorInvalidCurrent: "Error: Invalid current. Please enter a positive value.",
                errorInvalidLength: "Error: Invalid length. Please enter a positive value.",
                warningTempExceeds: "WARNING: Effective operating temperature ({temp}°C) exceeds {wireType} maximum rating ({maxTemp}°C)! Wire insulation may fail.",
                cautionTempClose: "CAUTION: Effective operating temperature ({temp}°C) is close to {wireType} maximum rating ({maxTemp}°C). Consider using a higher temperature rated wire.",
                warningUnsafe: "The calculated cable size may not be safe for this wire type! Consider: using a higher temperature rated wire, reducing ambient temperature, improving cooling, or increasing cable size to reduce heat generation.",
                installationAir: "In Air",
                installationConduit: "In Conduit",
                installationIsolated: "Isolated/Insulated",
                materialCopper: "Copper",
                materialAluminum: "Aluminum"
            },
            de: {
                title: "DC-Kabeldurchmesser-Rechner",
                subtitle: "Berechnen Sie die erforderliche Kabelquerschnittsfläche und den Durchmesser für DC-Elektrosysteme",
                supports: "Unterstützt 12V, 24V, 48V, 50V DC-Systeme",
                language: "Sprache",
                inputParameters: "Eingabeparameter",
                systemVoltage: "Systemspannung (V)",
                current: "Strom (A)",
                cableLength: "Kabellänge (m)",
                maxVoltageDrop: "Max. Spannungsabfall (%)",
                ambientTemperature: "Umgebungstemperatur",
                lengthType: "Längentyp",
                oneWay: "Einfach",
                roundTrip: "Hin- und Rückweg",
                cableMaterial: "Kabelmaterial",
                installationMethod: "Installationsmethode",
                wireType: "Drahttyp",
                calculate: "Berechnen",
                calculationResults: "Berechnungsergebnisse",
                inputParams: "Eingabeparameter",
                systemVoltageLabel: "Systemspannung:",
                currentLabel: "Strom:",
                cableLengthLabel: "Kabellänge:",
                maxVoltageDropLabel: "Max. Spannungsabfall:",
                materialLabel: "Material:",
                wireTypeLabel: "Drahttyp:",
                installationLabel: "Installation:",
                ambientTempLabel: "Umgebungstemp.:",
                effectiveTempLabel: "Effektive Temp.:",
                requiredCableSize: "Erforderliche Kabelgröße",
                crossSectionalArea: "Querschnittsfläche:",
                diameter: "Durchmesser:",
                cableWeight: "Kabelgewicht:",
                recommendedStandardSizes: "Empfohlene Standardgrößen",
                metric: "Metrisch:",
                awg: "AWG:",
                voltageDropRecommended: "Spannungsabfall mit empfohlenen Größen",
                roundedUp: "aufgerundet, überdimensioniert um",
                largestAvailable: "größte verfügbare, unterdimensioniert um",
                with: "Mit",
                safetyWarning: "Sicherheitshinweis:",
                safetyText: "Konsultieren Sie für kritische Anwendungen immer einen qualifizierten Elektriker oder Elektroingenieur.",
                safetyNote: "Dieses Tool bietet nur Berechnungen für den Spannungsabfall und ersetzt nicht das professionelle Ingenieururteil.",
                errorInvalidVoltage: "Fehler: Ungültige Spannung. Bitte geben Sie einen Wert zwischen 0 und {maxVoltage}V ein.",
                errorInvalidCurrent: "Fehler: Ungültiger Strom. Bitte geben Sie einen positiven Wert ein.",
                errorInvalidLength: "Fehler: Ungültige Länge. Bitte geben Sie einen positiven Wert ein.",
                warningTempExceeds: "WARNUNG: Effektive Betriebstemperatur ({temp}°C) überschreitet die maximale Bewertung von {wireType} ({maxTemp}°C)! Die Drahtisolierung kann versagen.",
                cautionTempClose: "VORSICHT: Effektive Betriebstemperatur ({temp}°C) liegt nahe an der maximalen Bewertung von {wireType} ({maxTemp}°C). Erwägen Sie die Verwendung eines Drahtes mit höherer Temperaturbewertung.",
                warningUnsafe: "Die berechnete Kabelgröße ist möglicherweise nicht sicher für diesen Drahttyp! Erwägen Sie: Verwendung eines Drahtes mit höherer Temperaturbewertung, Reduzierung der Umgebungstemperatur, Verbesserung der Kühlung oder Erhöhung der Kabelgröße zur Reduzierung der Wärmeentwicklung.",
                installationAir: "In Luft",
                installationConduit: "In Leitung",
                installationIsolated: "Isoliert/Isoliert",
                materialCopper: "Kupfer",
                materialAluminum: "Aluminium"
            },
            fr: {
                title: "Calculateur de Diamètre de Câble CC",
                subtitle: "Calculez la section transversale et le diamètre de câble requis pour les systèmes électriques CC",
                supports: "Prend en charge les systèmes CC 12V, 24V, 48V, 50V",
                language: "Langue",
                inputParameters: "Paramètres d'entrée",
                systemVoltage: "Tension système (V)",
                current: "Courant (A)",
                cableLength: "Longueur du câble (m)",
                maxVoltageDrop: "Chute de tension max (%)",
                ambientTemperature: "Température ambiante",
                lengthType: "Type de longueur",
                oneWay: "Aller simple",
                roundTrip: "Aller-retour",
                cableMaterial: "Matériau du câble",
                installationMethod: "Méthode d'installation",
                wireType: "Type de fil",
                calculate: "Calculer",
                calculationResults: "Résultats du calcul",
                inputParams: "Paramètres d'entrée",
                systemVoltageLabel: "Tension système:",
                currentLabel: "Courant:",
                cableLengthLabel: "Longueur du câble:",
                maxVoltageDropLabel: "Chute de tension max:",
                materialLabel: "Matériau:",
                wireTypeLabel: "Type de fil:",
                installationLabel: "Installation:",
                ambientTempLabel: "Temp. ambiante:",
                effectiveTempLabel: "Temp. effective:",
                requiredCableSize: "Taille de câble requise",
                crossSectionalArea: "Section transversale:",
                diameter: "Diamètre:",
                cableWeight: "Poids du câble:",
                recommendedStandardSizes: "Tailles standard recommandées",
                metric: "Métrique:",
                awg: "AWG:",
                voltageDropRecommended: "Chute de tension avec tailles recommandées",
                roundedUp: "arrondi à la hausse, surdimensionné de",
                largestAvailable: "plus grande disponible, sous-dimensionné de",
                with: "Avec",
                safetyWarning: "Avertissement de sécurité:",
                safetyText: "Consultez toujours un électricien qualifié ou un ingénieur électricien pour les applications critiques.",
                safetyNote: "Cet outil fournit uniquement des calculs pour la chute de tension et ne remplace pas le jugement d'ingénierie professionnel.",
                errorInvalidVoltage: "Erreur: Tension invalide. Veuillez entrer une valeur entre 0 et {maxVoltage}V.",
                errorInvalidCurrent: "Erreur: Courant invalide. Veuillez entrer une valeur positive.",
                errorInvalidLength: "Erreur: Longueur invalide. Veuillez entrer une valeur positive.",
                warningTempExceeds: "AVERTISSEMENT: La température de fonctionnement effective ({temp}°C) dépasse la cote maximale de {wireType} ({maxTemp}°C)! L'isolation du fil peut échouer.",
                cautionTempClose: "ATTENTION: La température de fonctionnement effective ({temp}°C) est proche de la cote maximale de {wireType} ({maxTemp}°C). Envisagez d'utiliser un fil avec une cote de température plus élevée.",
                warningUnsafe: "La taille de câble calculée peut ne pas être sûre pour ce type de fil! Envisagez: d'utiliser un fil avec une cote de température plus élevée, de réduire la température ambiante, d'améliorer le refroidissement ou d'augmenter la taille du câble pour réduire la génération de chaleur.",
                installationAir: "À l'air libre",
                installationConduit: "Dans un conduit",
                installationIsolated: "Isolé/Isolé",
                materialCopper: "Cuivre",
                materialAluminum: "Aluminium"
            },
            sv: {
                title: "DC Kabeldiametraräknare",
                subtitle: "Beräkna erforderlig kabeltvärsnittsarea och diameter för DC-elektriska system",
                supports: "Stöder 12V, 24V, 48V, 50V DC-system",
                language: "Språk",
                inputParameters: "Indataparametrar",
                systemVoltage: "Systemspänning (V)",
                current: "Ström (A)",
                cableLength: "Kabellängd (m)",
                maxVoltageDrop: "Max spänningsfall (%)",
                ambientTemperature: "Omgivningstemperatur",
                lengthType: "Längdtyp",
                oneWay: "Enkelriktad",
                roundTrip: "Tur och retur",
                cableMaterial: "Kabelmaterial",
                installationMethod: "Installationsmetod",
                wireType: "Trådtyp",
                calculate: "Beräkna",
                calculationResults: "Beräkningsresultat",
                inputParams: "Indataparametrar",
                systemVoltageLabel: "Systemspänning:",
                currentLabel: "Ström:",
                cableLengthLabel: "Kabellängd:",
                maxVoltageDropLabel: "Max spänningsfall:",
                materialLabel: "Material:",
                wireTypeLabel: "Trådtyp:",
                installationLabel: "Installation:",
                ambientTempLabel: "Omgivningstemp.:",
                effectiveTempLabel: "Effektiv temp.:",
                requiredCableSize: "Erforderlig kabelstorlek",
                crossSectionalArea: "Tvärsnittsarea:",
                diameter: "Diameter:",
                cableWeight: "Kabelvikt:",
                recommendedStandardSizes: "Rekommenderade standardstorlekar",
                metric: "Metrisk:",
                awg: "AWG:",
                voltageDropRecommended: "Spänningsfall med rekommenderade storlekar",
                roundedUp: "avrundat uppåt, överdimensionerat med",
                largestAvailable: "största tillgängliga, underdimensionerat med",
                with: "Med",
                safetyWarning: "Säkerhetsvarning:",
                safetyText: "Konsultera alltid en kvalificerad elektriker eller elektroingenjör för kritiska tillämpningar.",
                safetyNote: "Detta verktyg tillhandahåller endast beräkningar för spänningsfall och ersätter inte professionell ingenjörsbedömning.",
                errorInvalidVoltage: "Fel: Ogiltig spänning. Ange ett värde mellan 0 och {maxVoltage}V.",
                errorInvalidCurrent: "Fel: Ogiltig ström. Ange ett positivt värde.",
                errorInvalidLength: "Fel: Ogiltig längd. Ange ett positivt värde.",
                warningTempExceeds: "VARNING: Effektiv driftstemperatur ({temp}°C) överskrider {wireType} maximala betyg ({maxTemp}°C)! Trådisolering kan misslyckas.",
                cautionTempClose: "FÖRSIKTIGHET: Effektiv driftstemperatur ({temp}°C) är nära {wireType} maximala betyg ({maxTemp}°C). Överväg att använda en tråd med högre temperaturbetyg.",
                warningUnsafe: "Den beräknade kabelstorleken kanske inte är säker för denna trådtyp! Överväg: att använda en tråd med högre temperaturbetyg, att minska omgivningstemperaturen, att förbättra kylningen eller att öka kabelstorleken för att minska värmegenerering.",
                installationAir: "I luften",
                installationConduit: "I rör",
                installationIsolated: "Isolerad/Isolerad",
                materialCopper: "Koppar",
                materialAluminum: "Aluminium"
            }
        };

        function t(key, params = {}) {
            let text = translations[currentLanguage][key] || translations['en'][key] || key;
            Object.keys(params).forEach(param => {
                text = text.replace(`{${param}}`, params[param]);
            });
            return text;
        }

        function changeLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('language', lang);
            document.documentElement.lang = lang;
            updateTranslations();
        }

        function updateTranslations() {
            // Update all elements with data-i18n attribute
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[currentLanguage][key]) {
                    el.textContent = t(key);
                }
            });

            // Update select options
            document.getElementById('roundTrip').innerHTML = `
                <option value="false">${t('oneWay')}</option>
                <option value="true">${t('roundTrip')}</option>
            `;

            document.getElementById('material').innerHTML = `
                <option value="copper">${t('materialCopper')}</option>
                <option value="aluminum">${t('materialAluminum')}</option>
            `;

            document.getElementById('installation').innerHTML = `
                <option value="air">${t('installationAir')}</option>
                <option value="conduit">${t('installationConduit')} (+10°C)</option>
                <option value="isolated">${t('installationIsolated')} (+20°C)</option>
            `;

            // Update button
            const btn = document.getElementById('calculateBtn');
            if (btn) btn.textContent = t('calculate');
        }

        // Constants
        const MAX_VOLTAGE = 50.0; // Maximum system voltage (V)
        const COPPER_RESISTIVITY_20C = 0.0175; // Ω·mm²/m
        const ALUMINUM_RESISTIVITY_20C = 0.0283; // Ω·mm²/m
        const COPPER_TEMP_COEFFICIENT = 0.00393; // per °C
        const ALUMINUM_TEMP_COEFFICIENT = 0.00403; // per °C
        const REFERENCE_TEMP = 20.0; // °C

        // Initialize language on page load
        document.addEventListener('DOMContentLoaded', function () {
            // Set language selector
            document.getElementById('language').value = currentLanguage;
            document.documentElement.lang = currentLanguage;

            // Set max voltage attribute
            document.getElementById('voltage').setAttribute('max', MAX_VOLTAGE);

            // Update translations
            updateTranslations();

            // Allow Enter key to trigger calculation
            const inputs = document.querySelectorAll('input, select');
            inputs.forEach(input => {
                input.addEventListener('keypress', function (e) {
                    if (e.key === 'Enter') {
                        calculate();
                    }
                });
            });
        });

        // Material densities (kg/m³)
        const COPPER_DENSITY = 8960; // kg/m³
        const ALUMINUM_DENSITY = 2700; // kg/m³

        // Weight per meter per mm² (g/m per mm²)
        const COPPER_WEIGHT_PER_MM2_PER_M = 8.96; // g/m per mm²
        const ALUMINUM_WEIGHT_PER_MM2_PER_M = 2.70; // g/m per mm²

        // Materials
        const materials = {
            copper: {
                nameKey: "materialCopper",
                resistivity20C: COPPER_RESISTIVITY_20C,
                tempCoefficient: COPPER_TEMP_COEFFICIENT,
                weightPerMm2PerM: COPPER_WEIGHT_PER_MM2_PER_M
            },
            aluminum: {
                nameKey: "materialAluminum",
                resistivity20C: ALUMINUM_RESISTIVITY_20C,
                tempCoefficient: ALUMINUM_TEMP_COEFFICIENT,
                weightPerMm2PerM: ALUMINUM_WEIGHT_PER_MM2_PER_M
            }
        };

        // Installation method adjustments (°C)
        const installationAdjustments = {
            air: 0.0,
            conduit: 10.0,
            isolated: 20.0
        };

        function getInstallationName(installation) {
            return t(`installation${installation.charAt(0).toUpperCase() + installation.slice(1)}`);
        }

        // Wire types
        const wireTypes = {
            flry: { name: "FLRY", maxTemp: 105.0, description: "Automotive thin-wall PVC" },
            "flry-a": { name: "FLRY-A", maxTemp: 105.0, description: "Automotive flexible stranded" },
            "flry-b": { name: "FLRY-B", maxTemp: 105.0, description: "Automotive symmetrical stranded" },
            thhn: { name: "THHN", maxTemp: 90.0, description: "Thermoplastic, high heat, nylon" },
            thwn: { name: "THWN", maxTemp: 75.0, description: "Thermoplastic, heat/water resistant" },
            xlpe: { name: "XLPE", maxTemp: 90.0, description: "Cross-linked polyethylene" },
            pvc: { name: "PVC", maxTemp: 70.0, description: "Standard PVC" },
            silicon: { name: "Silicone", maxTemp: 200.0, description: "Silicone rubber" },
            generic: { name: "Generic", maxTemp: 90.0, description: "Generic wire" }
        };

        // Standard metric sizes (mm²)
        const standardMetricSizes = [0.5, 0.75, 1.0, 1.5, 2.5, 4.0, 6.0, 10.0, 16.0, 25.0, 35.0, 50.0, 70.0, 95.0, 120.0, 150.0, 185.0, 240.0];

        // AWG sizes
        const awgSizes = [
            { label: "18", area: 0.823 },
            { label: "16", area: 1.309 },
            { label: "14", area: 2.081 },
            { label: "12", area: 3.309 },
            { label: "10", area: 5.261 },
            { label: "8", area: 8.367 },
            { label: "6", area: 13.30 },
            { label: "4", area: 21.15 },
            { label: "2", area: 33.62 },
            { label: "1", area: 42.41 },
            { label: "1/0", area: 53.49 },
            { label: "2/0", area: 67.43 },
            { label: "3/0", area: 85.01 },
            { label: "4/0", area: 107.2 }
        ];

        // Temperature conversion
        function fahrenheitToCelsius(f) {
            return (f - 32) * 5 / 9;
        }

        function celsiusToFahrenheit(c) {
            return c * 9 / 5 + 32;
        }

        // Calculate resistivity at given temperature
        function calculateResistivityAtTemp(material, tempCelsius) {
            return material.resistivity20C * (1 + material.tempCoefficient * (tempCelsius - REFERENCE_TEMP));
        }

        // Calculate effective operating temperature
        function calculateEffectiveTemp(ambientTempCelsius, installation) {
            return ambientTempCelsius + installationAdjustments[installation];
        }

        // Validate wire temperature
        function validateWireTemperature(effectiveTempCelsius, wireType) {
            if (effectiveTempCelsius > wireType.maxTemp) {
                return {
                    isValid: false,
                    message: t('warningTempExceeds', {
                        temp: effectiveTempCelsius.toFixed(1),
                        wireType: wireType.name,
                        maxTemp: wireType.maxTemp
                    })
                };
            }
            if (effectiveTempCelsius > wireType.maxTemp * 0.9) {
                return {
                    isValid: true,
                    message: t('cautionTempClose', {
                        temp: effectiveTempCelsius.toFixed(1),
                        wireType: wireType.name,
                        maxTemp: wireType.maxTemp
                    })
                };
            }
            return { isValid: true, message: "" };
        }

        // Calculate required cable area
        function calculateCableArea(voltage, current, length, maxVoltageDropPercent, material, roundTrip, ambientTempCelsius, installation) {
            const maxVoltageDrop = voltage * (maxVoltageDropPercent / 100.0);
            const distanceFactor = roundTrip ? 2.0 : 1.0;
            const effectiveTemp = calculateEffectiveTemp(ambientTempCelsius, installation);
            const resistivity = calculateResistivityAtTemp(material, effectiveTemp);
            return (current * resistivity * length * distanceFactor) / maxVoltageDrop;
        }

        // Calculate diameter from area
        function areaToDiameter(area) {
            return 2 * Math.sqrt(area / Math.PI);
        }

        // Calculate cable weight
        // weight = area (mm²) × length (m) × weightPerMm2PerM (g/m per mm²)
        // For round trip, multiply by 2 (both conductors)
        function calculateCableWeight(area, length, material, roundTrip) {
            const weightPerMeter = area * material.weightPerMm2PerM; // g/m
            const totalWeight = weightPerMeter * length; // g
            return roundTrip ? totalWeight * 2 : totalWeight; // g
        }

        // Find smallest metric size that is >= required area (round up)
        function findClosestMetricSize(requiredArea) {
            // Find the smallest standard size that is >= required area
            for (const size of standardMetricSizes) {
                if (size >= requiredArea) {
                    return { size: size, diff: size - requiredArea };
                }
            }
            // If required area exceeds all standard sizes, return the largest
            const largestSize = standardMetricSizes[standardMetricSizes.length - 1];
            return { size: largestSize, diff: requiredArea - largestSize };
        }

        // Find smallest AWG size (largest area) that is >= required area (round up)
        function findClosestAWG(requiredArea) {
            // AWG sizes are ordered from smallest to largest area
            // Find the first AWG size where area >= required area
            for (const awg of awgSizes) {
                if (awg.area >= requiredArea) {
                    return { label: awg.label, area: awg.area, diff: awg.area - requiredArea };
                }
            }
            // If required area exceeds all AWG sizes, return the largest
            const largestAWG = awgSizes[awgSizes.length - 1];
            return { label: largestAWG.label, area: largestAWG.area, diff: requiredArea - largestAWG.area };
        }

        // Main calculation function
        function calculate() {
            // Get input values
            const voltage = parseFloat(document.getElementById('voltage').value);
            const current = parseFloat(document.getElementById('current').value);
            const length = parseFloat(document.getElementById('length').value);
            const maxVoltageDropPercent = parseFloat(document.getElementById('voltageDrop').value) || 3.0;
            const ambientTemp = parseFloat(document.getElementById('temperature').value) || 20.0;
            const tempUnit = document.getElementById('tempUnit').value;
            const roundTrip = document.getElementById('roundTrip').value === 'true';
            const materialKey = document.getElementById('material').value;
            const installation = document.getElementById('installation').value;
            const wireTypeKey = document.getElementById('wireType').value;

            // Validation
            if (!voltage || voltage <= 0 || voltage > MAX_VOLTAGE) {
                alert(t('errorInvalidVoltage', { maxVoltage: MAX_VOLTAGE }));
                return;
            }
            if (!current || current <= 0) {
                alert(t('errorInvalidCurrent'));
                return;
            }
            if (!length || length <= 0) {
                alert(t('errorInvalidLength'));
                return;
            }

            // Convert temperature to Celsius
            let ambientTempCelsius = ambientTemp;
            if (tempUnit === 'F') {
                ambientTempCelsius = fahrenheitToCelsius(ambientTemp);
            }

            // Get material and wire type
            const material = materials[materialKey];
            const wireType = wireTypes[wireTypeKey];

            // Calculate effective temperature
            const effectiveTemp = calculateEffectiveTemp(ambientTempCelsius, installation);

            // Validate wire temperature
            const tempValidation = validateWireTemperature(effectiveTemp, wireType);

            // Calculate required area
            const requiredArea = calculateCableArea(voltage, current, length, maxVoltageDropPercent, material, roundTrip, ambientTempCelsius, installation);
            const requiredDiameter = areaToDiameter(requiredArea);

            // Find standard sizes
            const metricResult = findClosestMetricSize(requiredArea);
            const awgResult = findClosestAWG(requiredArea);

            // Calculate actual voltage drops
            const resistivity = calculateResistivityAtTemp(material, effectiveTemp);
            const distanceFactor = roundTrip ? 2.0 : 1.0;
            const actualDropMetric = (current * resistivity * length * distanceFactor) / metricResult.size;
            const actualDropPercentMetric = (actualDropMetric / voltage) * 100;
            const actualDropAWG = (current * resistivity * length * distanceFactor) / awgResult.area;
            const actualDropPercentAWG = (actualDropAWG / voltage) * 100;

            // Display results
            document.getElementById('result-voltage').textContent = `${voltage.toFixed(1)} V`;
            document.getElementById('result-current').textContent = `${current.toFixed(2)} A`;
            document.getElementById('result-length').textContent = `${length.toFixed(2)} m (${roundTrip ? t('roundTrip') : t('oneWay')})`;
            document.getElementById('result-drop').textContent = `${maxVoltageDropPercent.toFixed(2)}% (${(voltage * maxVoltageDropPercent / 100).toFixed(2)} V)`;
            document.getElementById('result-material').textContent = t(material.nameKey);
            document.getElementById('result-wiretype').textContent = `${wireType.name} (Max: ${wireType.maxTemp}°C)`;
            document.getElementById('result-installation').textContent = getInstallationName(installation);
            document.getElementById('result-ambient').textContent = `${ambientTemp.toFixed(1)}°${tempUnit} (${ambientTempCelsius.toFixed(1)}°C)`;
            document.getElementById('result-effective-temp').textContent = `${effectiveTemp.toFixed(1)}°C`;

            // Display warning if needed
            const warningDiv = document.getElementById('warning');
            if (!tempValidation.isValid || tempValidation.message) {
                warningDiv.classList.remove('hidden');
                if (!tempValidation.isValid) {
                    warningDiv.className = 'mb-4 p-4 rounded-lg bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800';
                    warningDiv.innerHTML = `<div class="text-red-800 dark:text-red-200 font-semibold">⚠️ ${tempValidation.message}</div><div class="text-sm text-red-700 dark:text-red-300 mt-2">${t('warningUnsafe')}</div>`;
                } else {
                    warningDiv.className = 'mb-4 p-4 rounded-lg bg-yellow-100 dark:bg-yellow-900/20 border border-yellow-300 dark:border-yellow-800';
                    warningDiv.innerHTML = `<div class="text-yellow-800 dark:text-yellow-200 font-semibold">⚠️ ${tempValidation.message}</div>`;
                }
            } else {
                warningDiv.classList.add('hidden');
            }

            // Calculate weights
            const requiredWeight = calculateCableWeight(requiredArea, length, material, roundTrip);
            const metricWeight = calculateCableWeight(metricResult.size, length, material, roundTrip);
            const awgWeight = calculateCableWeight(awgResult.area, length, material, roundTrip);

            // Format weight display (show kg if >= 1000g, otherwise g)
            function formatWeight(weightGrams) {
                if (weightGrams >= 1000) {
                    return `${(weightGrams / 1000).toFixed(2)} kg`;
                }
                return `${weightGrams.toFixed(1)} g`;
            }

            // Display required size
            document.getElementById('result-area').textContent = `${requiredArea.toFixed(2)} mm²`;
            document.getElementById('result-diameter').textContent = `${requiredDiameter.toFixed(2)} mm`;
            document.getElementById('result-weight').textContent = formatWeight(requiredWeight);

            // Display recommended sizes
            document.getElementById('result-metric').textContent = `${metricResult.size.toFixed(2)} mm²`;
            document.getElementById('result-metric-diff').textContent = metricResult.diff >= 0
                ? `(${t('roundedUp')} ${metricResult.diff.toFixed(2)} mm²)`
                : `(${t('largestAvailable')} ${Math.abs(metricResult.diff).toFixed(2)} mm²)`;
            document.getElementById('result-metric-weight').textContent = `${t('cableWeight')} ${formatWeight(metricWeight)}`;

            document.getElementById('result-awg').textContent = `AWG ${awgResult.label} (${awgResult.area.toFixed(2)} mm²)`;
            document.getElementById('result-awg-diff').textContent = awgResult.diff >= 0
                ? `(${t('roundedUp')} ${awgResult.diff.toFixed(2)} mm²)`
                : `(${t('largestAvailable')} ${Math.abs(awgResult.diff).toFixed(2)} mm²)`;
            document.getElementById('result-awg-weight').textContent = `${t('cableWeight')} ${formatWeight(awgWeight)}`;

            // Display voltage drops
            document.getElementById('result-drop-metric-label').textContent = `${t('with')} ${metricResult.size.toFixed(2)} mm²:`;
            document.getElementById('result-drop-metric').textContent = `${actualDropMetric.toFixed(2)} V (${actualDropPercentMetric.toFixed(2)}%)`;
            document.getElementById('result-drop-awg-label').textContent = `${t('with')} AWG ${awgResult.label} (${awgResult.area.toFixed(2)} mm²):`;
            document.getElementById('result-drop-awg').textContent = `${actualDropAWG.toFixed(2)} V (${actualDropPercentAWG.toFixed(2)}%)`;

            // Show results section
            const resultsSection = document.getElementById('results');
            resultsSection.classList.remove('hidden');

            // Announce results to screen readers
            const srAnnouncement = document.getElementById('sr-announcement');
            const announcement = `${t('calculationResults')}. ${t('requiredCableSize')}: ${requiredArea.toFixed(2)} ${t('crossSectionalArea')}. ${t('recommendedStandardSizes')}: ${t('metric')} ${metricResult.size.toFixed(2)} mm², ${t('awg')} ${awgResult.label}.`;
            srAnnouncement.textContent = announcement;

            // Focus on results section for keyboard users and scroll into view
            resultsSection.setAttribute('tabindex', '-1');
            setTimeout(() => {
                resultsSection.focus();
                resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }

    </script>
</body>

</html>